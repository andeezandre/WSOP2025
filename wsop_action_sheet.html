<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WSOP Action Sales Tracker</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fafafa;
        }
        .section h2 {
            color: #34495e;
            margin-top: 0;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
            font-weight: bold;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .add-btn {
            background-color: #27ae60;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        .add-btn:hover {
            background-color: #219a52;
        }
        .remove-btn {
            background-color: #e74c3c;
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        .remove-btn:hover {
            background-color: #c0392b;
        }
        .summary {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .total {
            font-size: 18px;
            color: #2c3e50;
            border-top: 2px solid #3498db;
            padding-top: 10px;
        }
        .export-btn {
            background-color: #9b59b6;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        .export-btn:hover {
            background-color: #8e44ad;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸŽ° WSOP Action Sales Tracker</h1>
        
        <div class="section">
            <h2>Tournament Schedule</h2>
            <table id="tournamentTable">
                <thead>
                    <tr>
                        <th>Event #</th>
                        <th>Tournament Name</th>
                        <th>Buy-in</th>
                        <th>Date</th>
                        <th>Action Sold (%)</th>
                        <th>Markup (%)</th>
                        <th>Revenue</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" placeholder="e.g., #1" class="event-num"></td>
                        <td><input type="text" placeholder="e.g., $500 Casino Employees" class="tourney-name"></td>
                        <td><input type="number" placeholder="500" class="buyin"></td>
                        <td><input type="date" class="date"></td>
                        <td><input type="number" placeholder="50" min="0" max="100" class="action-sold"></td>
                        <td><input type="number" placeholder="10" min="0" class="markup"></td>
                        <td class="revenue">$0</td>
                        <td><button class="remove-btn" onclick="removeRow(this)">Remove</button></td>
                    </tr>
                </tbody>
            </table>
            <button class="add-btn" onclick="addTournamentRow()">+ Add Tournament</button>
        </div>

        <div class="section">
            <h2>Investors/Backers</h2>
            <table id="investorTable">
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Contact</th>
                        <th>Total Investment</th>
                        <th>Percentage Owned</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" placeholder="Investor Name" class="investor-name"></td>
                        <td><input type="text" placeholder="Email/Phone" class="contact"></td>
                        <td><input type="number" placeholder="1000" class="investment"></td>
                        <td class="percentage">0%</td>
                        <td><button class="remove-btn" onclick="removeInvestorRow(this)">Remove</button></td>
                    </tr>
                </tbody>
            </table>
            <button class="add-btn" onclick="addInvestorRow()">+ Add Investor</button>
        </div>

        <div class="section">
            <h2>Results Tracking</h2>
            <table id="resultsTable">
                <thead>
                    <tr>
                        <th>Tournament</th>
                        <th>Result</th>
                        <th>Prize Won</th>
                        <th>Net Profit/Loss</th>
                        <th>Investor Payout</th>
                        <th>Your Share</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><select class="tournament-select"><option value="">Select Tournament</option></select></td>
                        <td><input type="text" placeholder="e.g., 15th place" class="result"></td>
                        <td><input type="number" placeholder="0" class="prize"></td>
                        <td class="net-result">$0</td>
                        <td class="investor-payout">$0</td>
                        <td class="your-share">$0</td>
                    </tr>
                </tbody>
            </table>
            <button class="add-btn" onclick="addResultRow()">+ Add Result</button>
        </div>

        <div class="summary">
            <h2>Financial Summary</h2>
            <div class="summary-item">
                <span>Total Buy-ins:</span>
                <span id="totalBuyins">$0</span>
            </div>
            <div class="summary-item">
                <span>Total Action Revenue:</span>
                <span id="totalRevenue">$0</span>
            </div>
            <div class="summary-item">
                <span>Total Investments Received:</span>
                <span id="totalInvestments">$0</span>
            </div>
            <div class="summary-item">
                <span>Your Bankroll Requirement:</span>
                <span id="bankrollReq">$0</span>
            </div>
            <div class="summary-item total">
                <span>Net Position:</span>
                <span id="netPosition">$0</span>
            </div>
        </div>

        <button class="export-btn" onclick="exportToCSV()">ðŸ“Š Export to CSV</button>
    </div>

    <script>
        function calculateRevenue(row) {
            const buyin = parseFloat(row.querySelector('.buyin').value) || 0;
            const actionSold = parseFloat(row.querySelector('.action-sold').value) || 0;
            const markup = parseFloat(row.querySelector('.markup').value) || 0;
            
            const actionAmount = buyin * (actionSold / 100);
            const revenue = actionAmount * (1 + markup / 100);
            
            row.querySelector('.revenue').textContent = '$' + revenue.toFixed(2);
            updateSummary();
            updateTournamentSelects();
        }

        function addTournamentRow() {
            const tbody = document.querySelector('#tournamentTable tbody');
            const newRow = tbody.rows[0].cloneNode(true);
            
            // Clear all inputs
            newRow.querySelectorAll('input').forEach(input => input.value = '');
            newRow.querySelector('.revenue').textContent = '$0';
            
            tbody.appendChild(newRow);
            attachTournamentListeners(newRow);
        }

        function removeRow(btn) {
            if (document.querySelectorAll('#tournamentTable tbody tr').length > 1) {
                btn.closest('tr').remove();
                updateSummary();
                updateTournamentSelects();
            }
        }

        function attachTournamentListeners(row) {
            row.querySelectorAll('.buyin, .action-sold, .markup').forEach(input => {
                input.addEventListener('input', () => calculateRevenue(row));
            });
        }

        function addInvestorRow() {
            const tbody = document.querySelector('#investorTable tbody');
            const newRow = tbody.rows[0].cloneNode(true);
            
            newRow.querySelectorAll('input').forEach(input => input.value = '');
            newRow.querySelector('.percentage').textContent = '0%';
            
            tbody.appendChild(newRow);
            attachInvestorListeners(newRow);
        }

        function removeInvestorRow(btn) {
            if (document.querySelectorAll('#investorTable tbody tr').length > 1) {
                btn.closest('tr').remove();
                updateInvestorPercentages();
            }
        }

        function attachInvestorListeners(row) {
            row.querySelector('.investment').addEventListener('input', updateInvestorPercentages);
        }

        function updateInvestorPercentages() {
            const totalInvestment = Array.from(document.querySelectorAll('.investment'))
                .reduce((sum, input) => sum + (parseFloat(input.value) || 0), 0);
            
            document.querySelectorAll('#investorTable tbody tr').forEach(row => {
                const investment = parseFloat(row.querySelector('.investment').value) || 0;
                const percentage = totalInvestment > 0 ? (investment / totalInvestment * 100).toFixed(1) : 0;
                row.querySelector('.percentage').textContent = percentage + '%';
            });
            
            updateSummary();
        }

        function addResultRow() {
            const tbody = document.querySelector('#resultsTable tbody');
            const newRow = tbody.rows[0].cloneNode(true);
            
            newRow.querySelectorAll('input').forEach(input => input.value = '');
            newRow.querySelectorAll('.net-result, .investor-payout, .your-share').forEach(cell => {
                cell.textContent = '$0';
            });
            
            tbody.appendChild(newRow);
            attachResultListeners(newRow);
            updateTournamentSelects();
        }

        function attachResultListeners(row) {
            row.querySelector('.prize').addEventListener('input', () => calculateResult(row));
        }

        function calculateResult(row) {
            const tournamentSelect = row.querySelector('.tournament-select');
            const prize = parseFloat(row.querySelector('.prize').value) || 0;
            
            if (!tournamentSelect.value) return;
            
            // Find corresponding tournament data
            const tournamentRows = document.querySelectorAll('#tournamentTable tbody tr');
            let buyin = 0, actionSold = 0;
            
            tournamentRows.forEach(tRow => {
                const eventName = tRow.querySelector('.event-num').value + ' - ' + tRow.querySelector('.tourney-name').value;
                if (eventName === tournamentSelect.value) {
                    buyin = parseFloat(tRow.querySelector('.buyin').value) || 0;
                    actionSold = parseFloat(tRow.querySelector('.action-sold').value) || 0;
                }
            });
            
            const netResult = prize - buyin;
            const investorPayout = netResult * (actionSold / 100);
            const yourShare = netResult - investorPayout;
            
            row.querySelector('.net-result').textContent = '$' + netResult.toFixed(2);
            row.querySelector('.investor-payout').textContent = '$' + investorPayout.toFixed(2);
            row.querySelector('.your-share').textContent = '$' + yourShare.toFixed(2);
        }

        function updateTournamentSelects() {
            const selects = document.querySelectorAll('.tournament-select');
            const tournaments = [];
            
            document.querySelectorAll('#tournamentTable tbody tr').forEach(row => {
                const eventNum = row.querySelector('.event-num').value;
                const name = row.querySelector('.tourney-name').value;
                if (eventNum && name) {
                    tournaments.push(eventNum + ' - ' + name);
                }
            });
            
            selects.forEach(select => {
                const currentValue = select.value;
                select.innerHTML = '<option value="">Select Tournament</option>';
                tournaments.forEach(tournament => {
                    const option = document.createElement('option');
                    option.value = tournament;
                    option.textContent = tournament;
                    if (tournament === currentValue) option.selected = true;
                    select.appendChild(option);
                });
            });
        }

        function updateSummary() {
            const buyins = Array.from(document.querySelectorAll('.buyin'))
                .reduce((sum, input) => sum + (parseFloat(input.value) || 0), 0);
            
            const revenue = Array.from(document.querySelectorAll('#tournamentTable .revenue'))
                .reduce((sum, cell) => sum + parseFloat(cell.textContent.replace('$', '')) || 0, 0);
            
            const investments = Array.from(document.querySelectorAll('.investment'))
                .reduce((sum, input) => sum + (parseFloat(input.value) || 0), 0);
            
            const bankrollReq = buyins - investments;
            const netPosition = investments - bankrollReq;
            
            document.getElementById('totalBuyins').textContent = '$' + buyins.toFixed(2);
            document.getElementById('totalRevenue').textContent = '$' + revenue.toFixed(2);
            document.getElementById('totalInvestments').textContent = '$' + investments.toFixed(2);
            document.getElementById('bankrollReq').textContent = '$' + bankrollReq.toFixed(2);
            document.getElementById('netPosition').textContent = '$' + netPosition.toFixed(2);
        }

        function exportToCSV() {
            let csv = 'WSOP Action Sales Report\n\n';
            
            // Tournament data
            csv += 'TOURNAMENTS\n';
            csv += 'Event,Name,Buy-in,Date,Action Sold %,Markup %,Revenue\n';
            document.querySelectorAll('#tournamentTable tbody tr').forEach(row => {
                const cells = row.querySelectorAll('input, .revenue');
                const values = Array.from(cells).slice(0, -1).map(cell => 
                    cell.tagName === 'INPUT' ? cell.value : cell.textContent
                );
                csv += values.join(',') + '\n';
            });
            
            csv += '\nINVESTORS\n';
            csv += 'Name,Contact,Investment,Percentage\n';
            document.querySelectorAll('#investorTable tbody tr').forEach(row => {
                const name = row.querySelector('.investor-name').value;
                const contact = row.querySelector('.contact').value;
                const investment = row.querySelector('.investment').value;
                const percentage = row.querySelector('.percentage').textContent;
                csv += `${name},${contact},${investment},${percentage}\n`;
            });
            
            // Download CSV
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'wsop_action_sales.csv';
            a.click();
            window.URL.revokeObjectURL(url);
        }

        // Initialize event listeners
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('#tournamentTable tbody tr').forEach(attachTournamentListeners);
            document.querySelectorAll('#investorTable tbody tr').forEach(attachInvestorListeners);
            document.querySelectorAll('#resultsTable tbody tr').forEach(attachResultListeners);
        });
    </script>
</body>
</html>